// ************************************************************************** //
//                                                                            //
//                                                        :::      ::::::::   //
//   PhoneBook.class.cpp                                :+:      :+:    :+:   //
//                                                    +:+ +:+         +:+     //
//   By: vtarreau <vtarreau@student.42.fr>          +#+  +:+       +#+        //
//                                                +#+#+#+#+#+   +#+           //
//   Created: 2016/04/04 15:25:41 by vtarreau          #+#    #+#             //
//   Updated: 2016/04/04 17:43:35 by vtarreau         ###   ########.fr       //
//                                                                            //
// ************************************************************************** //

#include "PhoneBook.class.hpp"

PhoneBook::PhoneBook() {
	contactNbr = 0;
	prompt();
	return ;
}

PhoneBook::~PhoneBook() {
}

void PhoneBook::prompt() 
{
	std::cout << "\033[34mBienvenue dans XXPhoneBook2000XX\033[0m" << std::endl;
	std::cout << "\033[34mLes commandes disponibles sont : ADD - SEARCH - EXIT\033[0m" << std::endl;
	std::cout << "\033[34mVeuillez entrer une commande\033[0m" << std::endl;

	std::string cmd;

	while (42) {
		std::cout << "\033[32mXXPHONEBOOK2000XX ?>\033[0m ";
		if (std::cin.eof()) {
			std::cout << std::endl;
			std::exit(1);
		}
		std::cin >> cmd;
		if (cmd == "ADD")
			add();
		else if (cmd == "SEARCH")
			search();
		else if (cmd == "EXIT")
			exit();
		else {
			std::cout << "Cette commande n'est disponible que dans XXPhoneBook3000XX" << std::endl;
			std::cout << "Les commandes disponibles sont : ADD - SEARCH - EXIT" << std::endl;
		}
	}
}

void PhoneBook::add()
{
	if (contactNbr >= 8)
	{
		std::cout << "Vous possedez le maximum de contacts (9)" << std::endl;
		std::cout << "Saissez le login du contact a remplacer ou taper CANCEL" << std::endl;
		
		std::string tmp;
		std::cin >> tmp;
		if (tmp != "CANCEL")
		{
			for (int i = 0; i < 8; i++) {
				if (contacts[i].getLogin() == tmp) {
					createContact(i);
					break ;
				}
			}
			std::cout << "Ce contact n'existe pas..." << std::endl;
		}
	}
	else 
	{
		createContact(contactNbr);
		contactNbr++;
	}
		
}

void PhoneBook::createContact(int key)
{
	std::string tmp;

	std::cout << "Creation du contact..." << std::endl;

	std::cout << "Entrer un prenom" << std::endl;
	std::cin >> tmp;
	contacts[key].setFirstName(tmp);

	std::cout << "Entrer un nom" << std::endl;
	std::cin >> tmp;
	contacts[key].setLastName(tmp);

	std::cout << "Entrer un nickname" << std::endl;
	std::cin >> tmp;
	contacts[key].setNickname(tmp);

	std::cout << "Entrer un login" << std::endl;
	std::cin >> tmp;
	contacts[key].setLogin(tmp);

	std::cout << "Entrer un code postal" << std::endl;
	std::cin >> tmp;
	contacts[key].setPostalAddress(tmp);

	std::cout << "Entrer une adresse mail" << std::endl;
	std::cin >> tmp;
	contacts[key].setEmailAddress(tmp);

	std::cout << "Entrer une date de naissance" << std::endl;
	std::cin >> tmp;
	contacts[key].setBirthdayDate(tmp);

	std::cout << "Entrer un plat favoris" << std::endl;
	std::cin >> tmp;
	contacts[key].setFavoriteMeal(tmp);

	std::cout << "Entrer la couleur de vos sous vetements" << std::endl;
	std::cin >> tmp;
	contacts[key].setUnderwearColor(tmp);

	std::cout << "Entrer votre pire secret" << std::endl;
	std::cin >> tmp;
	contacts[key].setDarkestSecret(tmp);
	
//	std::cout << contacts[key].getFirstName();
//	std::cout << " a ete cree" << std::endl;

}

void PhoneBook::search()
{
}

 void PhoneBook::exit() 
{
		std::cout << "Fermeture de XXPhoneBook2000XX" << std::endl;
		std::exit(1);
}
